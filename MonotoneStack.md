Monotone Stack(zz)

### 定义

​		单调栈就是从栈顶到栈底的元素是严格递增（or递减）的栈，单调栈只能在栈顶操作。

### 理解

​		为了更好的理解单调栈，则可将单调栈用生活情形模拟实现，例如：我们借用拿号排队的场景来说明下。现在有很多人在排队买可乐，每个人手里都拿着号，越靠前的人手里的号越小，但是号不一定是连续的。小明拿了号后并没有去排队，而是跑去约会了。等他回来后，发现队伍已经排得很长了，他不能直接插入到队伍里，不然人家以为他是来插队的。小明只能跑到队伍最后，挨个询问排队人手里的号，小明认为号比他大的人都是“插队”的，于是小明就会施魔法把这些人变消失，直到小明找到号比他小的为止。

​		在上面这个场景里，大家排的队伍就像是单调栈，因为大家手里拿的号是单调递增的。而小明找自己位置的这个过程就是元素加入单调栈的过程。新加入的元素如果加到栈顶后，如果栈里的元素不再是单调递增了，那么我们就删除加入前的栈顶元素，就像小明施魔法把“插队”的人变消失一样。直到新元素加入后，栈依然是单调递增时，我们才把元素加进栈里。（这样做的目的是“维护”单调栈，是单调栈保持原来的单调性不变）



### 具体进栈过程

- 对于单调递增栈，若当前进栈元素为e，从栈顶开始遍历元素，把小于e或者等于e的元素弹出栈，直接遇到一个大于e的元素或者栈为空为止，然后再把e压入栈中。

- 对于单调递减栈，则每次弹出的是大于e或者等于e的元素。

  

### 单调栈的性质

1. 单调栈里的元素具有单调性

2. 元素加入栈前，会在栈顶端把破坏栈单调性的元素都删除

3. 使用单调递增栈可以找到比他小的元素，使用单调递增栈可以找到元素比他大的元素。

4. 单调栈的维护是 O(n) 级的时间复杂度，因为所有元素只会进入栈一次，并且出栈后再也不会进栈了。

对于第三条性质的解释（最常用的性质）：

对于单调栈的第三条性质，分别讨论这两种情况（假设不存在两个相同的元素）：

1. 当单调栈中的元素是单调递增的时候：
   + 当a > b 时，则将元素a插入栈顶，新的栈顶则为a

   + 当a < b 时，则将从当前栈顶位置向前查找（边查找，栈顶元素边出栈），直到找到第一个比a小的数，停止查找，将元素a插入栈顶（在当前找到的数之后，即此时元素a找到了自己的“位置”）



2. 当单调栈中的元素是单调递减的时候，则有：

   + 当a < b 时，则将元素a插入栈顶，新的栈顶则为a

   + 当a > b 时，则将从当前栈顶位置向前查找（边查找，栈顶元素边出栈），直到找到第一个比a大的数，停止查找，将元素a插入栈顶（在当前找到的数之后，即此时元素a找到了自己的“位置”）



### 一个单调递增栈的例子：

进栈元素分别为3，4，2，6，4，5，2，3

| 第i步 | 操作            | 结果  |
| :---- | :-------------- | :---- |
| 1     | 3进栈           | 3     |
| 2     | 3出栈，4进栈    | 4     |
| 3     | 2进栈           | 4 2   |
| 4     | 2、4出栈，6进栈 | 6     |
| 5     | 4进栈           | 6 4   |
| 6     | 4出栈，5进栈    | 6 5   |
| 7     | 2进栈           | 6 5 2 |
| 8     | 2出栈，3进栈    | 6 5 3 |

这里提供一个递增的单调栈的图，元素依次为3，2，8，4，5，7，6，4
注意看随着i的变化，栈中元素的变化。

![monotone queue example 1](https://endlesslethe.com/wordpress/wp-content/uploads/2017/12/monotone-queue-example-1.png)





参考：

1、https://blog.csdn.net/liujian20150808/article/details/50752861

2、https://endlesslethe.com/monotone-queue-and-stack-tutorial.html